{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/index.js"],"sourcesContent":["\nimport axios from 'axios';\n\nconst KEY = '40858309-c006559b48084651189398a1c';\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nexport async function fetchImages(query, page, perPage) {\n  const response = await axios.get(\n    `?key=${KEY}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${perPage}`\n  );\n  return response.data;\n}\n\n","import SlimSelect from 'slim-select';\nimport 'slim-select/styles';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport 'modern-normalize/modern-normalize.css';\nimport SimpleLightbox from \"simplelightbox\";\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { fetchImages } from './pixabay-api';\n\nconst elements = {\n    searchForm : document.getElementById('search-form'),\n    gallery : document.querySelector('.gallery'),\n    inputSerch: document.querySelector('.serch-form-input'),\n    btnSerch: document.querySelector('.serch-form-btn'),\n    btnLoadMore: document.querySelector('.load-more'),\n};\n\nlet query = '';\nlet page = 1;\nlet simpleLightBox;\nconst perPage = 40;\n\nelements.searchForm.addEventListener('submit', onSearchForm);\n\nfunction onSearchForm(e) {\n    e.preventDefault();\n    page = 1;\n    query = e.currentTarget.elements.searchQuery.value.trim();\n    elements.gallery.innerHTML = '';\n\n    if (!e.currentTarget.elements.searchQuery.value.trim()) {\n        iziToast.error({\n            title: 'Error',\n            position: 'center',\n            message: 'The search string cannot be empty. Please specify your search query.',\n        });\n        return;\n    }\n\n    fetchImages(query, page, perPage)\n        .then(data => {\n            if (data.totalHits === 0) {\n                iziToast.error({\n                    title: 'Error',\n                    position: 'center',\n                    message: 'Sorry, there are no images matching your search query. Please try again.',\n                });\n        \n            } else {\n                renderGallery(data.hits);\n                simpleLightBox = new SimpleLightbox('.gallery a').refresh();\n                iziToast.success({\n                    position: 'center',\n                    message: `Hooray! We found ${data.totalHits} images.`,\n                });\n            }\n        })\n        .catch(error => {\n            iziToast.error({\n                title: 'Error',\n                position: 'center',\n                message: `${error.message} Something went wrong!`,\n            });\n            console.log(error)\n        })\n    .finally(() => {\n        elements.searchForm.reset();\n        window.addEventListener('scroll', showLoadMorePage);\n    });\n}\n\n\nfunction renderGallery(images) {\n    // Перевірка чи існує галерея перед вставкою даних\n    if (!elements.gallery) {\n        return;\n    }\n\n    const markup = images\n        .map(image => {\n        const {\n            id,\n            largeImageURL,\n            webformatURL,\n            tags,\n            likes,\n            views,\n            comments,\n            downloads,\n        } = image;\n        return `\n                <div class=\"photo-card\">\n                    <a href='${largeImageURL}' class=\"card-link js-card-link\">\n                        <img class=\"photo\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n                        <div class=\"info\">\n                            <p class=\"info-item\">\n                            <b>Views</b>\n                            ${views}\n                            </p>\n                            <p class=\"info-item\">\n                            <b>Comments</b>\n                            ${comments}\n                            </p>\n                            <p class=\"info-item\">\n                            <b>Downloads</b>\n                            ${downloads}\n                            </p>\n                        </div>\n                    </a>\n                </div>`;\n        })\n        .join('');\n\n    elements.gallery.insertAdjacentHTML('beforeend', markup);\n\n    // Цей код дозволяє автоматично прокручувати сторінку на висоту 2 карток галереї, коли вона завантажується\n    if (page === 1) {\n        return\n    }\n    const { height: cardHeight } =\n        elements.gallery\n        .firstElementChild.getBoundingClientRect();\n    \n    window.scrollBy({\n        top: cardHeight * 2,\n        behavior: 'smooth',\n    });\n}\n\nfunction onloadMore() {\n  page += 1;\n  simpleLightBox.destroy();\n  fetchImages(query, page, perPage)\n    .then(data => {\n      renderGallery(data.hits);\n      simpleLightBox = new SimpleLightbox('.gallery a').refresh();\n\n      const totalPages = Math.ceil(data.totalHits / perPage);\n\n        if (page >= totalPages) {\n            iziToast.warning({\n                    position: 'center',\n                    message: \"We're sorry, but you've reached the end of search results.\",\n            });\n            window.removeEventListener('scroll', showLoadMorePage);\n        }\n    })\n    .catch(error => console.log(error));\n}\n\nfunction checkIfEndOfPage() {\n  return (\n    window.innerHeight + window.scrollY >=\n    document.documentElement.scrollHeight\n  );\n}\n\n// Функція, яка виконуеться, якщо користувач дійшов до кінця сторінки\nfunction showLoadMorePage() {\n  if (checkIfEndOfPage()) {\n    onloadMore();\n  }\n}\n"],"names":["KEY","axios","fetchImages","query","page","perPage","elements","simpleLightBox","onSearchForm","e","iziToast","data","renderGallery","SimpleLightbox","error","showLoadMorePage","images","markup","image","id","largeImageURL","webformatURL","tags","likes","views","comments","downloads","cardHeight","onloadMore","totalPages","checkIfEndOfPage"],"mappings":"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"}